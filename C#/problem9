using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;
using System.Linq;
using Student_Api.DataSimulation;
using Student_Api.Model;

namespace Student_Api.Controllers
{
    //[Route("api/[controller]")]
    [Route("api/Student")]
    [ApiController]
    public class StudentController : ControllerBase
    {
        [HttpGet("All", Name = "GetStudentsList")]
        public ActionResult<IEnumerable<Student>> GetStudentsList()
        {
            return Ok(StudentDataSimulation.StudentList);
        }

        [HttpGet("Passed", Name = "GetPassedStudents")]
        public ActionResult<IEnumerable<Student>> GetPassedStudents()
        {
            var passedStudents = StudentDataSimulation.StudentList.Where(student => student.Grade >= 50).ToList();
            return Ok(passedStudents);
        }

        [HttpGet("Average", Name = "GetAverageGrade")]
        public ActionResult<double>GetAverageGrade()
        {
            if(StudentDataSimulation.StudentList.Count == 0)
            {
                return NotFound("No students found...");
            }

            var averageGrade = StudentDataSimulation.StudentList.Average(student => student.Grade);
            return Ok(averageGrade);
        }
    }
}
